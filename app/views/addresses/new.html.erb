<br><br>
<h2 style="text-align: left;">Adresa za dostavu</h2>

<div class="row">

  <%= form_for(@address1) do |f| %>
  <div class="col-md-6">
    <div class="address1">
      <% unless flash[:address_error].blank? %>
          <%= flash[:address_error] %>
      <% end %><br>
      
      <%= f.label :Ime_i_Prezime %>
      <%= f.text_field :name, class: "form-control" %>
      <br>
      <%= f.label :Adresa %>
      <%= f.text_field :address_name, class: 'form-control' %>
      <br>
      <%= f.label :Grad %>
      <%= f.text_field :city, class: 'form-control' %>
      <br>

      <%= f.label :Regija %>
      <%= f.text_field :region, class: 'form-control' %>
      <br>

      <%= f.label :ZIP %>
      <%= f.text_field :zip, class: 'form-control' %>
      <br>

      <% @array_of_states = []; %>
      <% @array_of_states << "Bosna i Hercegovina" %>
      <% @array_of_states << "Hrvatska" %>
      <% @array_of_states << "Slovenija" %>
      <% @array_of_states << "Austrija" %>
      <%= f.label :Država %><br>
      <%= f.select("state", @array_of_states.collect {|p| [ p] }, { :include_blank => "Odaberite državu", :selected => params[:get_state], :class => 'form-control', :role => "menu"})%>
      <br>
      <br>

      <%= f.label :Broj_telefona %>
      <%= f.text_field :phone, class: 'form-control' %>
      <br>
    </div>
      <br><br>

      <div class="row">
        <div class="col-md-6">
            <h2 style="text-align: left;">Adresa za račun</h2>
          </div>
          <div class="col-md-6">
            <div class="checkbox">
                <input type="checkbox" id="checkbox1" onchange="myFunction()" value="nesto" checked> Koristi adresu za dostavu
            </div>
          </div>
      </div>

      <table class="table_total2"> 
        <tr>
          <td style="padding-right:18px; padding-left:0px; margin:1px; padding-top:0px;">
            <%= button_to "ODUSTANI", home_path, :class => "btn btn-default", :method => :get  %></td>
          <td style="padding-left:0px; padding-right:0px; padding-top:0px; margin-right:1px;"><%= f.submit "NASTAVI", class: "btn btn-primary"%></td>
        </tr>
      </table>

      <% end %>

      <br>

      <% a = params[:name] %>

    <div class="address2">

      <%= form_for(@address1) do |f2| %>

        <%= f2.label :Ime_i_Prezime %>
        <%= f2.text_field :name, class: "form-control" %>
        <br>
        <%= f2.label :Adresa %>
        <%= f2.text_field :address_name, class: 'form-control' %>
        <br>
        <%= f2.label :Grad %>
        <%= f2.text_field :city, class: 'form-control' %>
        <br>

        <%= f2.label :Regija %>
        <%= f2.text_field :region, class: 'form-control' %>
        <br>

        <%= f2.label :ZIP %>
        <%= f2.text_field :zip, class: 'form-control' %>
        <br>

        <%= f2.label :Država %><br>
        <%= f2.select("state", @array_of_states.collect {|p| [ p] }, { :include_blank => "Odaberite državu", :selected => params[:get_state], :class => "form-control" }) %>
        <br>
        <br>

        <%= f2.label :Broj_telefona %>
        <%= f2.text_field :phone, class: 'form-control' %>
      <% end %>

    </div>

      <%10.times do %>
        <br>
      <% end %>
  </div> 

<% if @cart.id != 0 %>
  <div class="col-md-6">

    <table class="status_table">
      <tr class="status_tr">
        <td class="status_11">KORPA
        <td class="status_21">DOSTAVA
        <td class="status_31">PLAĆANJE
      </tr>
    </table>

    <table border = "1" class="table_total">
    <tr>
      <td style="padding:20px; margin:10px;">
        <p style="text-align: left;"> <b>Narudžba</b> <%= @cart.get_total_number %> proizvoda 
        <% 13.times do %>
          &nbsp;
        <% end %>
        <br></p>
        <p style="text-align: right;"> Cijena <br> <b><%= @cart.get_total_price %>KM </b><br><br>
        Dostava <br> <b><%= @cart.get_delivery_price*@cart.items.length %>KM </b><br>
        <hr>
        <p style="text-align: right;">
        Ukupno <b><%= @cart.get_total_with_delivery %></b></p>
      </td>
    </tr>
  </table>
  </div>
<% else %>
  <div class="col-md-6">
    <table border = "1" class="table_total">
  <tr>
    <td style="padding:20px; margin:10px;">
      <p style="text-align: left;"> <b>Narudžba </b> 
        <span class="cart_total_number"><%= @cart.get_total_number %></span> proizvoda 
      <% 13.times do %>
        &nbsp;
      <% end %>
      <br></p>
      <p style="text-align: right;"> Cijena <br> 
        <b><span class="cart_price"><%= @cart.get_total_price %></span>KM </b><br><br>
        Dostava <br> 
        <b><span class="cart_delivery"><%= @cart.get_delivery_price %>KM </span></b><br>
        <hr>
      <p style="text-align: right;">
      Ukupno <b><span class="cart_total"><%= @cart.get_total_with_delivery %>KM</span></b></p>
    </td>
  </tr>
</table>
  </div>
<% end %>

</div>

<script type="text/javascript">

  document.getElementsByClassName("address2")[0].style.visibility = "hidden";
    function myFunction() {
      checked = document.getElementById("checkbox1").checked;
      if (checked == true)
        document.getElementsByClassName("address2")[0].style.visibility = "hidden";
      else
        document.getElementsByClassName("address2")[0].style.visibility = "visible";
    }

    $(window).bind('page:load', function(){
      $.ajax({
          url: '/addresses/single_item_price',
          type: 'GET',
          success: function(result) {
            if (result.number) {
              $(".cart_total_number").html(result.number);
              $(".cart_price").html(result.price);
              $(".cart_delivery").html(result.delivery);
              $(".cart_total").html(result.total);
            }
          }

      });

    });
    
</script>




